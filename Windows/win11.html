<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Windows 11</title>
    <link rel="stylesheet" href="../style.css">
  </head>

<body>
<h2> Windows 11</h2>
<h2> Bref</h2>
<pre>
Set-TimeZone -Id "FLE Standard Time"

net stop w32time & net start w32time
w32tm /config /syncfromflags:manual /manualpeerlist:time.windows.com /reliable:YES /update
net stop w32time & net start w32time

Get-appxpackage -allusers Microsoft.549981C3F5F10 | Remove-AppxPackage

echo добавить схему Максимальная производительность
powercfg -duplicatescheme e9a42b02-d5df-448d-aa00-03f14749eb61

powercfg /change monitor-timeout-ac 15

echo Отключить Автоматические обновления
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" /v NoAutoUpdate /t REG_DWORD /d 1 /f

irm https://massgrave.dev/get | iex
slmgr.vbs /xpr
powercfg /list
</pre>
<p>
<a href=https://www.microsoft.com/ru-ru/software-download/windows11>Download windows11 </a>

<h3>Запретить обновления до Windows 11</h3>
<ol>
<li><code>regedit \HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\ </code>
<li>Создать раздел <code>WindowsUpdate</code>
<li>Создать Параметр Dword32 <code>TargetReleaseVersion</code> Значение <code>1</code>
<li>Создать строковый парамер <code>TargetReleaseVersionInfo</code> и указаь номер версии текущей Windows, например <code>21H2</code>
<p> Текущую версию можно узнать через <code>winver</code>
<li>Создать строковый парамер <code>ProductVersion</code> со значением <code>Windows10</code>
<li><code>shutdown -r -f -t 3</code>
</ol>
<h3>Установка Windows 11 без подключения к Интернету</h3>
<ol>
<li>Shift+F10
<li>Выполните команду: <code>oobe\bypassnro</code>
<li>После перезагрузки компьютера на экране OOBE появится кнопка <b>I don’t have Internet</b>. 
<br>Нажмите ее, чтобы продолжить установку в режиме Limited setup, где вам будет предложено создать локального пользователя
</ol>	

<h3>Control</h3>
<p>Свойства сетевого адаптера
<code>control ncpa.cpl</code></p>
<p>Центр управления сетями и общим доступом
<code>control /name Microsoft.NetworkAndSharingCenter</code></p>
<p>Cкринсейвер
<code>control desk.cpl,,@screensaver</code></p>
<p>Cвойства системы
<code>control sysdm.cpl</code></p>
<p>Устройства и принтеры
<code>control printers</code></p>
<p>Учетные записи пользователе
<code>control userpasswords</code>
<code>control userpasswords2</code></p>
<p>Электропитание
<code>control powercfg.cpl</code></P>
<H3>Личный/Публичный</H3>
<p>Задать "тип подключенное к частной сети"
<code>secpol.msc</code>
<p>Слева — «Политики диспетчера списка сетей» |
Выбрать сетевой интерфейс | 
Закладка "сетевое расположение" | 
Тип расположения - "Личное"
<h3>Добавить адаптер OpenVPN</h3>
<p><code>C:\Program Files\OpenVPN\bin\tapctl.exe create --hwid ovpn-dco</code></p>
<h3>Отключить уведомления</h3>
<p><code>reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Notifications\Settings" /v Enabled /t REG_DWORD /d 0 /f</code>

<H3>mstsc Win11H24</H3>
Проблема 1с7
<p>Скопируйте оригинальные файлы mstsc.exe и mstscax.dll из каталога C:\windows\system32\ в любой каталог, например c:\temp
<p>Станьте владельцем файлов и выдайте себе права на изменения, например так:
<p><code>takeown /F C:\windows\system32\mstsc.exe</code>
<p><code>takeown /F C:\windows\system32\mstscax.dll</code>
<p><code>icacls C:\windows\system32\mstsc.exe /inheritance:d</code>
<p><code>icacls C:\windows\system32\mstscax.dll /inheritance:d</code>
<p><code>icacls C:\windows\system32\mstsc.exe /grant ВВЕДИТЕ ТУТ ИМЯ ПОЛЬЗОВАТЕЛЯ:F</code>
<p><code>icacls C:\windows\system32\mstscax.dll /grant ВВЕДИТЕ ТУТ ИМЯ ПОЛЬЗОВАТЕЛЯ:F</code>
<p>Замените файлы в каталоге C:\windows\system32\ файлами из резервной копии.
<p>Перерегистрируйте библиотеку
<p><code>regsvr32 C:\Windows\System32\mstscax.dll</code>

<p> Список необходимых файлов
<ol>
<li>  C:\Windows\System32\mstsc.exe
<li>  C:\Windows\System32\mstscax.dll
<li>C:\Windows\SystemResources\mstsc.exe.mun
<li>C:\Windows\SystemResources\mstscax.dll.mun
<p> RU
<li>C:\Windows\System32\ru-RU\mstsc.exe.mui
<li>C:\Windows\System32\ru-RU\mstscax.dll.mui

<p>или US
<li>C:\Windows\System32\en-US\mstsc.exe.mui
<li>C:\Windows\System32\en-US\mstscax.dll.mui





</body>
  </html>
