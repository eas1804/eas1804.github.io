<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Restic. backup</title>
    <link rel="stylesheet" href="../style.css">
  </head>
<body>
<h2>Windows. backup SSH, port 22</h2>

<a href=UTF8.cmd>utf8 Кирилица</a>
<table><tr><td><pre>
@echo off
rem taskkill /F /FI "ImageName eq 1c*"

set REMOTE_HOST=backup12345.backup.1cloudlab.com
set REMOTE_USER=backup12345
set REMOTE_PATH=/backup/restic/company/
set SSH_KEY_PATH=C:/Users/us/colocall.key
set RESTIC_PASSWORD_FILE=C:/Users/us/restic-password.txt

set FROM=C:\Base
set TAG=1c
restic -r sftp:%REMOTE_USER%@%REMOTE_HOST%:%REMOTE_PATH% -o "sftp.command=ssh -i %SSH_KEY_PATH% -o StrictHostKeyChecking=no %REMOTE_USER%@%REMOTE_HOST% -s sftp" backup  %FROM% --tag=%TAG%
</pre></td></tr></table>

<h2>Windows AWS</h2>
<table><tr><td><pre>
@echo off
rem taskkill /F /FI "ImageName eq 1c*"

set "RESTIC_REPO=s3:s3.amazonaws.com/shamoev.restic/restic"
set "RESTIC_PASSWORD_FILE=C:/Users/us/restic-password.txt"

set "FROM=C:\Base"
set "TAG=1c"

rem Запуск резервного копирования
restic -r %RESTIC_REPO% backup %FROM% --tag=%TAG%
</pre></td></tr></table>




<h2>Linux SSH</h2>
<table><tr><td><pre>
#!/bin/bash

PORT=23
REMOTE_HOST=u12345.your-storagebox.de
REMOTE_USER=u12345
REMOTE_PATH=/mnt/company/restic/
SSH_KEY_PATH=/root/.ssh/company_key
RESTIC_PASSWORD_FILE=/root/restic-password.txt

FROM=/mnt/1c/
TAG=1c

export RESTIC_PASSWORD_FILE

restic -r "sftp:${REMOTE_USER}@${REMOTE_HOST}:${REMOTE_PATH}" \
  -o "sftp.command=ssh -i ${SSH_KEY_PATH} -p ${PORT} -o StrictHostKeyChecking=no ${REMOTE_USER}@${REMOTE_HOST} -s sftp" \
backup ${FROM} --tag=${TAG}
</pre></td></tr></table>


</body>

