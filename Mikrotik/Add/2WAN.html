<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>–ß–∏—Å—Ç—ã–π Failover</title>
    <link rel="stylesheet" href="../../style.css">
  </head>

<body>
<h2>–†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –ø–æ–º–æ—â–∏ Netwatch</h2>
<p>–û—Å–Ω–æ–≤–Ω–æ–π –∫–∞–Ω–∞–ª: HelpTeh (ISP1). Gate: <b>94.62.137.1</b>
<p>–†–µ–∑–µ—Ä–≤–Ω—ã–π: Adamant (ISP2). Gate <b>212.26.133.105</b>

<ol>
<li>–î–æ–±–∞–≤–∏–º –º–∞—Ä—à—Ä—É—Ç—ã –∫ –∫–∞–∂–¥–æ–º—É –∏–∑ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ —Å —Ä–∞–∑–Ω—ã–º–∏ –¥–∏—Å—Ç–∞–Ω—Ü–∏—è–º–∏  –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏

<table><tr><td><pre>
/ip route
add comment=ISP1 distance=1 gateway=94.62.137.1
add comment=ISP2 distance=2 gateway=212.26.133.105
</pre></td></tr></table>
<li>–í—ã–±–∏—Ä–∞–µ–º –≤—ã—Å–æ–∫–æ–¥–æ—Å—Ç—É–ø–Ω—ã–π —Ö–æ—Å—Ç –∏ –¥–æ–±–∞–≤–ª—è–µ–º –∫ –Ω–µ–º—É –º–∞—Ä—à—Ä—É—Ç —á–µ—Ä–µ–∑ –ø–µ—Ä–≤–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
<table><tr><td><pre>
/ip route
add distance=1 dst-address=8.8.8.8/32 gateway=194.62.137.1
</pre></td></tr></table>
<li>Tools->Netwatch 
<p>–¥–æ–±–∞–≤–ª—è–µ–º —Ç–∞–º –Ω–æ–≤—ã–π —É–∑–µ–ª, –Ω–∞ –∑–∞–∫–ª–∞–¥–∫–µ Host —É–∫–∞–∑—ã–≤–∞–µ–º –∞–¥—Ä–µ—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –≤—ã—Å–æ–∫–æ–¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ —É–∑–ª–∞ 
<p>–∑–∞–∫–ª–∞–¥–µ Up –≤–≤–æ–¥–∏–º —Å–ª–µ–¥—É—é—â–∏–π —Å–∫—Ä–∏–ø—Ç
<p><code>/ip route set [find comment="ISP1"] distance=1</code>
<p>–∑–∞–∫–ª–∞–¥–µ Down –≤–≤–æ–¥–∏–º —Å–ª–µ–¥—É—é—â–∏–π —Å–∫—Ä–∏–ø—Ç
<p><code>/ip route set [find comment="ISP1"] distance=12</code>
<p>–¢–∞–∫ –∫–∞–∫ —É ISP2 –±—É–¥–µ—Ç distance=2 (2<12), —Ç–æ —Ç—Ä–∞—Ñ–∏–∫ –ø–æ–π–¥–µ—Ç —á–µ—Ä–µ–∑ ISP2
</ol>
<hr>
<h2>–ß–∏—Å—Ç—ã–π Failover (–æ—Å–Ω–æ–≤–Ω–æ–π + —Ä–µ–∑–µ—Ä–≤–Ω—ã–π). –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç</h2>
<ol>
<li>–£–¥–∞–ª–∏–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–∞ 0.0.0.0/0
<li>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
<p>–î–æ–±–∞–≤–∏–º –º–∞—Ä—à—Ä—É—Ç—ã –∫ 8.8.4.4 –∏ 9.9.9.9 —á–µ—Ä–µ–∑ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ —Å —Ä–∞–∑–Ω—ã–º–∏ scope –∏ target-scope
<table><tr><td><pre>
/ip route
add dst-address=8.8.4.4 gateway=194.62.137.1 scope=10 target-scope=10 comment="Check ISP1 via 8.8.4.4"
add dst-address=9.9.9.9 gateway=212.26.133.105 scope=10 target-scope=10 comment="Check ISP2 via 9.9.9.9"
</pre></td></tr></table>
<p>dst-address: –¶–µ–ª–µ–≤–æ–π IP –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ (8.8.4.4 –¥–ª—è ISP1, 9.9.9.9 –¥–ª—è ISP2).
<p>gateway: –®–ª—é–∑ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞.
<p>scope=10 –∏ target-scope=10: –≠—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ—Å—Ç—å –º–∞—Ä—à—Ä—É—Ç–æ–≤.

<li> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤
<p>–¢–µ–ø–µ—Ä—å –Ω–∞—Å—Ç—Ä–æ–∏–º –º–∞—Ä—à—Ä—É—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 8.8.4.4 –∏ 9.9.9.9 –∫–∞–∫ —à–ª—é–∑—ã. 
<p>–ï—Å–ª–∏ –º–∞—Ä—à—Ä—É—Ç –∫ 8.8.4.4 —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–º (ISP1 –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç), MikroTik –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—Å—è –Ω–∞ –º–∞—Ä—à—Ä—É—Ç —á–µ—Ä–µ–∑ 9.9.9.9 (ISP2).
<table><tr><td><pre>
/ip route
add dst-address=0.0.0.0/0 gateway=8.8.4.4 distance=10 scope=30 target-scope=11 comment="ISP1 recursive route"
add dst-address=0.0.0.0/0 gateway=9.9.9.9 distance=20 scope=30 target-scope=11 comment="ISP2 recursive route"
</pre></td></tr></table>
<p>gateway=8.8.4.4 –∏ gateway=9.9.9.9: –≠—Ç–∏ IP-–∞–¥—Ä–µ—Å–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–∞–∫ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ —à–ª—é–∑—ã.
<p>distance: –û—Å–Ω–æ–≤–Ω–æ–π –º–∞—Ä—à—Ä—É—Ç (ISP1) –∏–º–µ–µ—Ç –º–µ–Ω—å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (distance=10), —Ä–µ–∑–µ—Ä–≤–Ω—ã–π (ISP2) ‚Äî –±–æ–ª—å—à–∏–π (distance=20).
<p>scope=30 –∏ target-scope=11: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º scope –≤—ã—à–µ, —á–µ–º —É –º–∞—Ä—à—Ä—É—Ç–æ–≤ –∫ 8.8.4.4 –∏ 9.9.9.9


<p>üìå –ü–æ–≤–µ–¥–µ–Ω–∏–µ:

<p>‚Ä¢	–†–∞–±–æ—Ç–∞–µ—Ç ISP1.
<p>‚Ä¢	–ï—Å–ª–∏ –ø–∞–¥–∞–µ—Ç ‚Äî –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è ISP2.
<p>‚Ä¢	–ü—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ ISP1 –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ.
<p><img src=2wan.bmp>



</body>
  </html>
