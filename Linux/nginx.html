<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Nginx</title>
    <link rel="stylesheet" href="../style.css">
  </head>

<body>
<h2>Nginx</h2>
<h3>Перечиать конфиг</h3>
<p><code>nginx -s reload</code></p>
<h3>Закрыть доступ паролем </H3>
<p>Создали пользователя user01
<p><code>apt install apache2-utils</code></p>
<p><code>htpasswd -c /etc/nginx/.htpasswd user01</code></p>

<p>включим аутентификацию в nginx
<pre>
server {
	listen 80 default_server;

	root /var/www/html;
	index index.html index.htm index.nginx-debian.html index.php;
	server_name _;

    <B>auth_basic           "Administrator’s Area";
	auth_basic_user_file /etc/nginx/.htpasswd;</B>
	</pre>
<h3> Можно для каждого сайта сделать отдельный конфиг</h3>
<p><code>vi /etc/nginx/sites-enabled/mail.mlp.in.ua</code></p>
<pre>
server {
  listen 80;
  server_name <b>mail.mlp.in.ua;</B>
  <b>root /var/www/rainloop;</b>
  index index.php;
  access_log /var/log/nginx/mail.mlp.in.ua_access.log;
  error_log /var/log/nginx/mail.mlp.in.ua_error.log;
  location / {
    try_files $uri $uri/ /index.php?$query_string;
  }
</pre>
<p><code>ln -s /etc/nginx/sites-enabled/mail.mlp.in.ua /etc/nginx/sites-enabled/</code></p>
<h3> Config для php</h3>
<p><code>vi /etc/nginx/sites-enabled/default</code></p>
<pre>
server {
        listen 80 default_server;
        listen [::]:80 default_server;
<b>        root /var/www/html;</b>
        index <b>index.php</B> index.html index.htm index.nginx-debian.html;
        server_name _;

        location / {
                try_files $uri $uri/ =404;
        }

        location ~ \.php$ {
            set $root_path /var/www/html;
            fastcgi_pass unix:/run/php/php<b><u>8.2</u></b>-fpm.sock;
            fastcgi_index index.php;
            fastcgi_param SCRIPT_FILENAME $root_path$fastcgi_script_name;
            include fastcgi_params;
            fastcgi_param DOCUMENT_ROOT $root_path;
        }
}
</pre>

</body>
  </html>
