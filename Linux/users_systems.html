<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>–°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–ª–∏ –∏ –≥—Ä—É–ø–ø—ã</title>
    <link rel="stylesheet" href="../style.css">
  </head>

<body>
<h2>–°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–ª–∏ –∏ –≥—Ä—É–ø–ø—ã</h2>

<h3>C–æ–∑–¥–∞—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—É—é –≤ –ø—Ä–∞–≤–∞—Ö —Å–µ—Ä–≤–∏—Å–Ω—É—é –≥—Ä—É–ø–ø—É</h3>
–≤ —Ü–µ–ª—è—Ö –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
<p><code>addgroup --system --gid 14956 pihole</code>
<ul>
<li>--system ‚Äî –ø–æ–º–µ—á–∞–µ—Ç –≥—Ä—É–ø–ø—É, –∫–∞–∫ —Å–∏—Å—Ç–µ–º–Ω—É—é; 
–û–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è <b>–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –Ω—É–∂–¥ —Å–∏—Å—Ç–µ–º—ã/—Å–µ—Ä–≤–∏—Å–æ–≤</b>, –∞ –Ω–µ –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
<li>--gid 14956 ‚Äî —É–∫–∞–∑—ã–≤–∞–µ—Ç —è–≤–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≥—Ä—É–ø–ø—ã (GID) ‚Äî –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ 14956;
<li> pihole ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–≤–∞–µ–º–æ–π –≥—Ä—É–ø–ø—ã;
</ul>
<h3>C–æ–∑–¥–∞—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –≤ –ø—Ä–∞–≤–∞—Ö —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>

<pre>
adduser --system --gecos 'Unbound and Pihole DNS service' \
    --disabled-password --uid 14956 --ingroup pihole \
    --shell /sbin/nologin --home /opt/pihole/data pihole
</pre>
<ul>
<li> --system ‚Äî –ø–æ–º–µ—á–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–∞–∫ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ; 
<p>UID –±—É–¥–µ—Ç –≤–∑—è—Ç –∏–∑ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö UID (100‚Äì999), –µ—Å–ª–∏ –Ω–µ –∑–∞–¥–∞–Ω —è–≤–Ω–æ
<li> --gecos ‚Äî –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–¥–∞—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è;
<li> --disabled-password ‚Äî –æ—Ç–∫–ª—é—á–∞–µ—Ç –ø–∞—Ä–æ–ª—å —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–≤ —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –ø–æ–¥ –Ω–∏–º –Ω–µ–ª—å–∑—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ —Å –ø–æ–º–æ—â—å—é –ø–∞—Ä–æ–ª—è);
<li>--uid 14956 ‚Äî —É–∫–∞–∑—ã–≤–∞–µ—Ç —è–≤–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (UID) ‚Äî –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ 14956;
<li>--ingroup pihole ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–æ–∑–¥–∞–Ω–Ω—É—é —Ä–∞–Ω–µ–µ –≥—Ä—É–ø–ø—É pihole;
<li> --shell /sbin/nologin ‚Äî –û—Ç–∫–ª—é—á–∞–µ—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É. –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —É—á—ë—Ç–æ–∫;
<li> --home /opt/pihole/data ‚Äî –£–∫–∞–∑—ã–≤–∞–µ—Ç –¥–æ–º–∞—à–Ω–∏–π –∫–∞—Ç–∞–ª–æ–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –û–±—ã—á–Ω–æ –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —ç—Ç–æ –ø—É—Ç—å, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å —Å–µ—Ä–≤–∏—Å–æ–º.
<li>   pihole ‚Äî –∏–º—è —Å–æ–∑–¥–∞–≤–∞–µ–º–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
</ul>
<h3>–§–∞–π–ª —Å –ø–µ—Ä–µ—á–Ω–µ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã—Ö –ø—Ä–∞–≤ sudoers </h3>
<p><code>visudo -f /etc/sudoers.d/90_pihole</code>
<p>–±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å–ø–æ—Å–æ–± –¥–æ–±–∞–≤–∏—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑ –ø—Ä–∞–≤–∫–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ /etc/sudoers
<p>Cmnd_Alias ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Å–µ–≤–¥–æ–Ω–∏–º–∞ –¥–ª—è –Ω–∞–±–æ—Ä–∞ –∫–æ–º–∞–Ω–¥. –ó–¥–µ—Å—å —Ç—ã –∑–∞–¥–∞—ë—à—å —Å–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö docker-–∫–æ–º–∞–Ω–¥.
<p>–í—Å—ë –∂—ë—Å—Ç–∫–æ –ø—Ä–∏–≤—è–∑–∞–Ω–æ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É docker-compose.yml, —á—Ç–æ —Ö–æ—Ä–æ—à–æ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
<pre>
Cmnd_Alias PIHOLE_DOCKER = \
    /usr/bin/docker compose -f /opt/pihole/docker-compose.yml up, \
    /usr/bin/docker compose -f /opt/pihole/docker-compose.yml down

pihole ALL = (:docker) NOPASSWD: PIHOLE_DOCKER
</pre>
<p>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å pihole —Å–º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å:
<p>sudo -g docker /usr/bin/docker compose -f /opt/pihole/docker-compose.yml up
<p>sudo -g docker /usr/bin/docker compose -f /opt/pihole/docker-compose.yml down
<ol>
<li>üü¢ –ë–µ–∑ –∑–∞–ø—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è
<li>üîí –¢–æ–ª—å–∫–æ —Å—Ç—Ä–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
<li>üö´ –ù–µ –¥–∞—ë—Ç —à–∏—Ä–æ–∫–∏—Ö sudo-–ø—Ä–∞–≤
</body>
  </html>
